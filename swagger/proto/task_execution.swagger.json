{
  "swagger": "2.0",
  "info": {
    "title": "proto/task_execution.proto",
    "version": "version not set"
  },
  "schemes": [
    "http",
    "https"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/v1/jobs": {
      "get": {
        "summary": "List the TaskOps",
        "operationId": "ListJobs",
        "responses": {
          "200": {
            "description": "Description",
            "schema": {
              "$ref": "#/definitions/ga4gh_task_execJobListResponse"
            }
          }
        },
        "tags": [
          "TaskService"
        ]
      },
      "post": {
        "summary": "Run a task",
        "operationId": "RunTask",
        "responses": {
          "200": {
            "description": "Description",
            "schema": {
              "$ref": "#/definitions/ga4gh_task_execJobId"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/ga4gh_task_execTask"
            }
          }
        ],
        "tags": [
          "TaskService"
        ]
      }
    },
    "/v1/jobs-service": {
      "get": {
        "summary": "Get Service Info",
        "operationId": "GetServiceInfo",
        "responses": {
          "200": {
            "description": "Description",
            "schema": {
              "$ref": "#/definitions/ga4gh_task_execServiceInfo"
            }
          }
        },
        "tags": [
          "TaskService"
        ]
      }
    },
    "/v1/jobs/{value}": {
      "get": {
        "summary": "Get info about a running task",
        "operationId": "GetJob",
        "responses": {
          "200": {
            "description": "Description",
            "schema": {
              "$ref": "#/definitions/ga4gh_task_execJob"
            }
          }
        },
        "parameters": [
          {
            "name": "value",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "string"
          }
        ],
        "tags": [
          "TaskService"
        ]
      },
      "delete": {
        "summary": "Cancel a running task",
        "operationId": "CancelJob",
        "responses": {
          "200": {
            "description": "Description",
            "schema": {
              "$ref": "#/definitions/ga4gh_task_execJobId"
            }
          }
        },
        "parameters": [
          {
            "name": "value",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "string"
          }
        ],
        "tags": [
          "TaskService"
        ]
      }
    }
  },
  "definitions": {
    "ga4gh_task_execDockerExecutor": {
      "type": "object",
      "properties": {
        "cmd": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "string"
          },
          "title": "The command to be executed"
        },
        "imageName": {
          "type": "string",
          "format": "string",
          "title": "Docker Image name"
        },
        "stderr": {
          "type": "string",
          "format": "string",
          "title": "Path for stderr recording, blank if not storing to file"
        },
        "stdout": {
          "type": "string",
          "format": "string",
          "title": "Path for stdout recording, blank if not storing to file"
        }
      },
      "title": "A command line to be executed and the docker container to run it"
    },
    "ga4gh_task_execJob": {
      "type": "object",
      "properties": {
        "jobId": {
          "type": "string",
          "format": "string"
        },
        "logs": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ga4gh_task_execJobLog"
          }
        },
        "metadata": {
          "type": "object",
          "additionalProperties": {
            "type": "string",
            "format": "string"
          }
        },
        "state": {
          "$ref": "#/definitions/ga4gh_task_execState"
        },
        "task": {
          "$ref": "#/definitions/ga4gh_task_execTask"
        }
      },
      "title": "The description of the running instance of a task"
    },
    "ga4gh_task_execJobId": {
      "type": "object",
      "properties": {
        "value": {
          "type": "string",
          "format": "string"
        }
      },
      "title": "ID of an instance of a Task"
    },
    "ga4gh_task_execJobListRequest": {
      "type": "object",
      "properties": {
        "namePrefix": {
          "type": "string",
          "format": "string",
          "description": "Pipelines with names that match this prefix should be returned. If unspecified, all pipelines in the project, up to pageSize, will be returned."
        },
        "pageSize": {
          "type": "integer",
          "format": "int64",
          "description": "Number of pipelines to return at once. Defaults to 256, and max is 2048."
        },
        "pageToken": {
          "type": "string",
          "format": "string",
          "description": "Token to use to indicate where to start getting results. If unspecified, returns the first page of results."
        },
        "projectId": {
          "type": "string",
          "format": "string",
          "description": "Required. The name of the project to search for pipelines. Caller must have READ access to this project."
        }
      }
    },
    "ga4gh_task_execJobListResponse": {
      "type": "object",
      "properties": {
        "jobs": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ga4gh_task_execJob"
          }
        },
        "nextPageToken": {
          "type": "string",
          "format": "string"
        }
      }
    },
    "ga4gh_task_execJobLog": {
      "type": "object",
      "properties": {
        "commandLine": {
          "type": "string",
          "format": "string",
          "title": "The command line that was run"
        },
        "endTime": {
          "type": "string",
          "format": "string",
          "title": "When the command completed"
        },
        "exitCode": {
          "type": "integer",
          "format": "int32",
          "title": "Exit code of the program"
        },
        "startTime": {
          "type": "string",
          "format": "string",
          "title": "When the command was executed"
        },
        "stderr": {
          "type": "string",
          "format": "string",
          "title": "Sample of stderr (not guaranteed to be entire log)"
        },
        "stdout": {
          "type": "string",
          "format": "string",
          "title": "Sample of stdout (not guaranteed to be entire log)"
        }
      }
    },
    "ga4gh_task_execResources": {
      "type": "object",
      "properties": {
        "minimumCpuCores": {
          "type": "integer",
          "format": "int64",
          "title": "Minimum number of CPUs"
        },
        "minimumRamGb": {
          "type": "integer",
          "format": "int64",
          "title": "Minimum RAM required"
        },
        "preemptible": {
          "type": "boolean",
          "format": "boolean",
          "title": "Can schedule on resource that resource that can be preempted, like AWS Spot Instances"
        },
        "volumes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ga4gh_task_execVolume"
          },
          "title": "Volumes to be mounted into the docker container"
        },
        "zones": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "string"
          },
          "title": "optional scheduling information for systems where multiple compute zones are avalible"
        }
      }
    },
    "ga4gh_task_execServiceInfo": {
      "type": "object",
      "properties": {
        "storageConfig": {
          "type": "object",
          "additionalProperties": {
            "type": "string",
            "format": "string"
          },
          "title": "System specific key/value pairs\nExample for a shared file system based storage system:\nstorageType=sharedFile, baseDir=/path/to/shared/directory"
        }
      },
      "title": "Information about Task Execution Service\nMay include information related (but not limited to)\nresource availability and storage system information"
    },
    "ga4gh_task_execServiceInfoRequest": {
      "type": "object",
      "title": "Blank request message for service request"
    },
    "ga4gh_task_execState": {
      "type": "string",
      "enum": [
        "Unknown",
        "Queued",
        "Running",
        "Paused",
        "Complete",
        "Error",
        "SystemError",
        "Canceled"
      ],
      "default": "Unknown"
    },
    "ga4gh_task_execTask": {
      "type": "object",
      "properties": {
        "description": {
          "type": "string",
          "format": "string",
          "title": "free text description of task"
        },
        "docker": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ga4gh_task_execDockerExecutor"
          },
          "title": "An array of docker executions that will be run sequentially"
        },
        "inputs": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ga4gh_task_execTaskParameter"
          },
          "title": "Files to be copied into system before tasks"
        },
        "name": {
          "type": "string",
          "format": "string",
          "title": "user name for task"
        },
        "outputs": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ga4gh_task_execTaskParameter"
          },
          "title": "Files to be copied out of the system after tasks"
        },
        "projectId": {
          "type": "string",
          "format": "string",
          "title": "parameter for execution engine to define/store group information"
        },
        "resources": {
          "$ref": "#/definitions/ga4gh_task_execResources",
          "title": "Define required system resources to run job"
        },
        "taskId": {
          "type": "string",
          "format": "string",
          "title": "System defined identifier of task"
        }
      },
      "title": "The description of a task to be run"
    },
    "ga4gh_task_execTaskParameter": {
      "type": "object",
      "properties": {
        "description": {
          "type": "string",
          "format": "string",
          "title": "optional text description"
        },
        "directory": {
          "type": "boolean",
          "format": "boolean",
          "title": "data is a directory, if used for an output all the files in the directory\nwill be copied to the storage location"
        },
        "location": {
          "type": "string",
          "format": "string",
          "title": "location in long term storage, is a url specific to the implementing \nsystem. For example s3://my-object-store/file1 or gs://my-bucket/file2 or\nfile:///path/to/my/file"
        },
        "name": {
          "type": "string",
          "format": "string",
          "title": "name of the parameter"
        },
        "path": {
          "type": "string",
          "format": "string",
          "title": "path in the machine file system. Note, this MUST be a path that exists\nwithin one of the defined volumes"
        }
      },
      "title": "Parameters for Task"
    },
    "ga4gh_task_execVolume": {
      "type": "object",
      "properties": {
        "mountPoint": {
          "type": "string",
          "format": "string",
          "title": "mount point for volume inside the docker container"
        },
        "name": {
          "type": "string",
          "format": "string",
          "title": "Name of attached volume"
        },
        "sizeGb": {
          "type": "integer",
          "format": "int64",
          "title": "Minimum size"
        },
        "source": {
          "type": "string",
          "format": "string",
          "title": "Source volume, this would refer to an existing volume the execution engine\ncould identify. Leave blank if is to be a newly created volume\nVolumes loaded from a source will be mounted as read only"
        }
      },
      "description": "Attached volume request."
    }
  }
}
